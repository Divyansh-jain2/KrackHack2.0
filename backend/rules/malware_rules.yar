// rules/malware_rules.yar
import "pe"

rule SuspiciousPECharacteristics {
    meta:
        description = "Detects suspicious PE characteristics"
    
    condition:
        pe.is_pe and
        (
            pe.imports("CreateRemoteThread") or
            pe.sections[.name == ".vmp0"] or
            pe.characteristics & 0x2000  // IMAGE_FILE_DLL
        )
}

rule HighEntropySections {
    meta:
        description = "Detects sections with entropy > 7.0"
    
    condition:
        any section in pe.sections : (
            section.entropy > 7.0
        )
}